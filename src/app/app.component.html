<div class="app-wrapper">
  <app-navbar></app-navbar>
  <div class="main-layout">
    <!-- Side Navigation Bar -->
    <div class="sidebar-container" *ngIf="showSidebar" [class.minimized]="sidebarMinimized">
      <div class="sidebar">
        <div class="sidebar-header">
          <div class="header-left">
            <h4 *ngIf="!sidebarMinimized"><i class="fas fa-filter me-2"></i>Filters</h4>
            <button class="btn btn-sm btn-outline-light" *ngIf="!sidebarMinimized" (click)="clearFilters()">
              <i class="fas fa-times me-1"></i>Clear All
            </button>
          </div>
          <button class="btn btn-sm btn-outline-light toggle-btn" (click)="toggleSidebar()">
            <i class="fas" [class.fa-bars]="!sidebarMinimized" [class.fa-times]="sidebarMinimized"></i>
          </button>
        </div>

        <!-- Category Filter -->
        <div class="filter-section" *ngIf="!sidebarMinimized">
          <h5><i class="fas fa-tags me-2"></i>Categories</h5>
          <div class="category-list">
            <div class="form-check" *ngFor="let category of availableCategories">
              <input 
                class="form-check-input" 
                type="checkbox" 
                [id]="'category-' + category"
                [value]="category"
                [(ngModel)]="selectedCategories[category]"
                (change)="onFilterChange()">
              <label class="form-check-label" [for]="'category-' + category">
                {{ category }}
                <span class="category-count">({{ getCategoryCount(category) }})</span>
              </label>
            </div>
          </div>
        </div>

        <!-- Price Range Filter -->
        <div class="filter-section" *ngIf="!sidebarMinimized">
          <h5><i class="fas fa-dollar-sign me-2"></i>Price Range</h5>
          <div class="price-range">
            <div class="price-inputs">
              <div class="input-group mb-2">
                <span class="input-group-text">$</span>
                <input 
                  type="number" 
                  class="form-control" 
                  placeholder="Min"
                  [(ngModel)]="priceRange.min"
                  (input)="onFilterChange()">
              </div>
              <div class="input-group">
                <span class="input-group-text">$</span>
                <input 
                  type="number" 
                  class="form-control" 
                  placeholder="Max"
                  [(ngModel)]="priceRange.max"
                  (input)="onFilterChange()">
              </div>
            </div>
            <div class="price-slider">
              <input 
                type="range" 
                class="form-range" 
                min="0" 
                [max]="maxPrice" 
                [(ngModel)]="priceRange.min"
                (input)="onFilterChange()">
              <input 
                type="range" 
                class="form-range" 
                min="0" 
                [max]="maxPrice" 
                [(ngModel)]="priceRange.max"
                (input)="onFilterChange()">
            </div>
            <div class="price-display">
              <span>${{ priceRange.min || 0 }} - ${{ priceRange.max || maxPrice }}</span>
            </div>
          </div>
        </div>

        <!-- Stock Filter -->
        <div class="filter-section" *ngIf="!sidebarMinimized">
          <h5><i class="fas fa-box me-2"></i>Stock Status</h5>
          <div class="form-check">
            <input 
              class="form-check-input" 
              type="checkbox" 
              id="inStock"
              [(ngModel)]="inStockOnly"
              (change)="onFilterChange()">
            <label class="form-check-label" for="inStock">
              In Stock Only
            </label>
          </div>
        </div>

        <!-- Sort Options -->
        <div class="filter-section" *ngIf="!sidebarMinimized">
          <h5><i class="fas fa-sort me-2"></i>Sort By</h5>
          <select class="form-select" [(ngModel)]="sortBy" (change)="onFilterChange()">
            <option value="name">Name A-Z</option>
            <option value="name-desc">Name Z-A</option>
            <option value="price">Price Low to High</option>
            <option value="price-desc">Price High to Low</option>
            <option value="date">Newest First</option>
            <option value="date-desc">Oldest First</option>
          </select>
        </div>

        <!-- Filter Summary -->
        <div class="filter-summary" *ngIf="!sidebarMinimized && hasActiveFilters()">
          <h6><i class="fas fa-info-circle me-2"></i>Active Filters</h6>
          <div class="active-filters">
            <span class="filter-tag" *ngFor="let category of getSelectedCategories()">
              {{ category }}
              <i class="fas fa-times" (click)="removeCategoryFilter(category)"></i>
            </span>
            <span class="filter-tag" *ngIf="priceRange.min || priceRange.max">
              Price: ${{ priceRange.min || 0 }} - ${{ priceRange.max || maxPrice }}
              <i class="fas fa-times" (click)="clearPriceFilter()"></i>
            </span>
            <span class="filter-tag" *ngIf="inStockOnly">
              In Stock Only
              <i class="fas fa-times" (click)="inStockOnly = false; onFilterChange()"></i>
            </span>
          </div>
        </div>

        <!-- Minimized Icons -->
        <div class="minimized-icons" *ngIf="sidebarMinimized">
          <div class="icon-item" title="Categories" (click)="expandSidebar()">
            <i class="fas fa-tags"></i>
          </div>
          <div class="icon-item" title="Price Range" (click)="expandSidebar()">
            <i class="fas fa-dollar-sign"></i>
          </div>
          <div class="icon-item" title="Stock Status" (click)="expandSidebar()">
            <i class="fas fa-box"></i>
          </div>
          <div class="icon-item" title="Sort Options" (click)="expandSidebar()">
            <i class="fas fa-sort"></i>
          </div>
          <div class="icon-item" title="Active Filters" *ngIf="hasActiveFilters()" (click)="expandSidebar()">
            <i class="fas fa-info-circle"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="content-container" [class.sidebar-minimized]="sidebarMinimized">
      <router-outlet></router-outlet>
    </div>
  </div>
</div>
