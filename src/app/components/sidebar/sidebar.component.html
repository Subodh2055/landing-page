<div class="sidebar" [class.mobile-mode]="isMobile">
  <div class="sidebar-header">
    <div class="header-left">
      <h4><i class="fas fa-filter me-2"></i>Filters</h4>
      <button class="btn btn-sm"
              [class.btn-outline-primary]="!isMobile"
              [class.btn-outline-light]="isMobile"
              (click)="onClearAll()">
        Clear All
      </button>
    </div>
  </div>

  <!-- Category Filter -->
  <div class="filter-section">
    <h5><i class="fas fa-tags me-2"></i>Categories</h5>
    <div class="category-list">
      <div class="form-check" *ngFor="let category of availableCategories">
        <input
          class="form-check-input"
          type="checkbox"
          [id]="(isMobile ? 'mobile' : 'desktop') + '-category-' + category"
          [value]="category"
          [checked]="selectedCategories[category]"
          (change)="onCategoryChange(category, $any($event.target).checked)">
        <label class="form-check-label" [for]="(isMobile ? 'mobile' : 'desktop') + '-category-' + category">
          {{ category }}
          <span class="category-count">({{ getCategoryCount(category) }})</span>
        </label>
      </div>
      <!-- Fallback if no categories -->
      <div *ngIf="availableCategories.length === 0" class="text-muted">
        <p>No categories available</p>
      </div>
    </div>
  </div>

  <!-- Price Range Filter -->
  <div class="filter-section">
    <h5><i class="fas fa-dollar-sign me-2"></i>Price Range</h5>
    <div class="price-range">
      <div class="price-inputs">
        <div class="price-input">
          <label>Min Price</label>
          <input
            type="number"
            placeholder="0"
            [(ngModel)]="priceRange.min"
            (input)="onPriceRangeChange()">
        </div>
        <div class="price-input">
          <label>Max Price</label>
          <input
            type="number"
            [placeholder]="maxPrice.toString()"
            [(ngModel)]="priceRange.max"
            (input)="onPriceRangeChange()">
        </div>
      </div>
    </div>
  </div>

  <!-- Stock Filter -->
  <div class="filter-section">
    <h5><i class="fas fa-box me-2"></i>Stock Status</h5>
    <div class="stock-filter">
      <div class="form-check">
        <input
          class="form-check-input"
          type="checkbox"
          [id]="(isMobile ? 'mobile' : 'desktop') + '-inStock'"
          [checked]="inStockOnly"
          (change)="onStockChange($any($event.target).checked)">
        <label class="form-check-label" [for]="(isMobile ? 'mobile' : 'desktop') + '-inStock'">
          In Stock Only
        </label>
      </div>
    </div>
  </div>

  <!-- Sort Options -->
  <div class="filter-section">
    <h5><i class="fas fa-sort me-2"></i>Sort By</h5>
    <div class="sort-options">
      <select class="form-select"
              [ngModel]="sortBy"
              (change)="onSortChange($any($event.target).value)">
        <option value="name">Name A-Z</option>
        <option value="name-desc">Name Z-A</option>
        <option value="price">Price Low to High</option>
        <option value="price-desc">Price High to Low</option>
        <option value="date">Newest First</option>
        <option value="date-desc">Oldest First</option>
      </select>
    </div>
  </div>

  <!-- Active Filters -->
  <div class="active-filters" *ngIf="hasActiveFilters">
    <h6><i class="fas fa-tags me-2"></i>Active Filters</h6>
    <div class="filter-tags">
      <!-- Category Filters -->
      <span class="filter-tag" *ngFor="let category of getSelectedCategories()">
        {{ category }}
        <button class="remove-btn" (click)="onRemoveCategory(category)">
          <i class="fas fa-times"></i>
        </button>
      </span>
      
      <!-- Price Filter -->
      <span class="filter-tag" *ngIf="priceRange.min > 0 || priceRange.max < maxPrice">
        ₹{{ priceRange.min || 0 }} - ₹{{ priceRange.max || maxPrice }}
        <button class="remove-btn" (click)="onClearPrice()">
          <i class="fas fa-times"></i>
        </button>
      </span>
      
      <!-- Stock Filter -->
      <span class="filter-tag" *ngIf="inStockOnly">
        In Stock Only
        <button class="remove-btn" (click)="onRemoveStock()">
          <i class="fas fa-times"></i>
        </button>
      </span>
    </div>
  </div>
</div>
