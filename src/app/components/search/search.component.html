<div class="search-container">
  <!-- Advanced Search Bar -->
  <div class="search-bar-container">
    <div class="search-input-wrapper">
      <div class="search-icon">
        <i class="fas fa-search"></i>
      </div>
      <input 
        type="text" 
        [formControl]="searchControl"
        placeholder="Search products, categories, brands..."
        class="search-input"
        (focus)="onSearchFocus()"
        (blur)="onSearchBlur()">
      <div class="search-actions">
        <button class="filter-toggle-btn" (click)="showFilters = !showFilters">
          <i class="fas fa-filter"></i>
        </button>
        <button class="search-btn">
          <i class="fas fa-search"></i>
        </button>
      </div>
    </div>

    <!-- Search Suggestions Dropdown -->
    <div class="search-suggestions" *ngIf="showSuggestions">
      <div class="suggestions-header">
        <h6><i class="fas fa-search"></i> Search Results</h6>
      </div>
      
      <!-- Search Results -->
      <div class="search-results" *ngIf="(searchResults$ | async) as results">
        <div class="result-item" *ngFor="let product of results.slice(0, 5)" (click)="onProductClick(product)">
          <div class="product-image">
            <img [src]="product.image" [alt]="product.name">
          </div>
          <div class="product-info">
            <div class="product-name">{{ product.name }}</div>
            <div class="product-category">{{ product.category }}</div>
            <div class="product-price">{{ product.getFormattedPrice() }}</div>
          </div>
        </div>
        
        <div class="no-results" *ngIf="results.length === 0">
          <i class="fas fa-search"></i>
          <p>No products found</p>
        </div>
      </div>

      <!-- Recently Viewed -->
      <div class="recently-viewed" *ngIf="recentlyViewed.length > 0">
        <div class="section-header">
          <h6><i class="fas fa-clock"></i> Recently Viewed</h6>
        </div>
        <div class="recent-items">
          <div class="recent-item" *ngFor="let product of recentlyViewed.slice(0, 3)" (click)="onProductClick(product)">
            <img [src]="product.image" [alt]="product.name">
            <span>{{ product.name }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Advanced Filters -->
  <div class="advanced-filters" *ngIf="showFilters">
    <div class="filters-header">
      <h5><i class="fas fa-filter"></i> Advanced Filters</h5>
      <button class="clear-filters-btn" (click)="clearFilters()">
        <i class="fas fa-times"></i> Clear All
      </button>
    </div>

    <div class="filters-grid">
      <!-- Category Filter -->
      <div class="filter-section">
        <label>Category</label>
        <select [(ngModel)]="selectedFilters.category" (change)="onFilterChange()">
          <option value="">All Categories</option>
          <option *ngFor="let category of categories" [value]="category">
            {{ category }}
          </option>
        </select>
      </div>

      <!-- Brand Filter -->
      <div class="filter-section">
        <label>Brand</label>
        <select [(ngModel)]="selectedFilters.brand" (change)="onFilterChange()">
          <option value="">All Brands</option>
          <option *ngFor="let brand of brands" [value]="brand">
            {{ brand }}
          </option>
        </select>
      </div>

      <!-- Price Range Filter -->
      <div class="filter-section">
        <label>Price Range</label>
        <select [(ngModel)]="selectedFilters.priceRange" (change)="onFilterChange()">
          <option *ngFor="let range of priceRanges" [ngValue]="range">
            {{ range.label }}
          </option>
        </select>
      </div>

      <!-- Rating Filter -->
      <div class="filter-section">
        <label>Minimum Rating</label>
        <div class="rating-filter">
          <div class="rating-options">
            <button 
              *ngFor="let rating of ratings" 
              [class.active]="selectedFilters.rating === rating"
              (click)="selectedFilters.rating = rating; onFilterChange()">
              <span class="stars">{{ '★'.repeat(rating) }}{{ '☆'.repeat(5 - rating) }}</span>
              <span class="rating-text">& Up</span>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recommendations Section -->
  <div class="recommendations-section" *ngIf="recommendedProducts.length > 0">
    <div class="section-header">
      <h4><i class="fas fa-star"></i> Recommended for You</h4>
      <a href="#" class="view-all">View All</a>
    </div>
    
    <div class="recommendations-grid">
      <div class="recommendation-card" *ngFor="let product of recommendedProducts">
        <div class="product-image">
          <img [src]="product.image" [alt]="product.name">
          <div class="product-overlay">
            <button class="quick-view-btn">
              <i class="fas fa-eye"></i>
            </button>
            <button class="wishlist-btn">
              <i class="fas fa-heart"></i>
            </button>
          </div>
        </div>
        <div class="product-details">
          <h6 class="product-name">{{ product.name }}</h6>
          <div class="product-rating">
            <span class="stars">{{ product.getRatingStars() }}</span>
            <span class="rating-count">({{ product.reviews }})</span>
          </div>
          <div class="product-price">
            <span class="current-price">{{ product.getFormattedPrice() }}</span>
            <span class="original-price" *ngIf="product.hasDiscount()">
              ₹{{ product.originalPrice }}
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
